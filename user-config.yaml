#cloud-config
autoinstall:
  version: 1
  identity:
    hostname: ubuntu-server
    password: "$6$.mXU.Raz4YERUY3P$ohe.s8CHkeQwDuetCRi4GGiXrd07irtJ51c7n1ujP15TR63m85nOkH83UCvh.YO90COxyJ3VLbLAcxD.sDqq90"
    username: ubuntu
  network:
    version: 2
    ethernets:
      eth0:
        dhcp4: true
        addresses: [192.168.1.254/24]
        gateway4: 192.168.1.1
        nameservers:
          addresses: [1.1.1.1,1.0.0.1]
        dhcp6: true
  ssh:
    install-server: true
  apt:
    preserver_source_list: false
    geoip: false
    mirror-selection:
      primary:
        - arches: [default]
          uri: http://archive.ubuntu.com/ubuntu
  late-commands:
    - "touch /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo '[Enable Reboot]' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'Identity=unix-user:ubuntu' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'Action=org.freedesktop.login1.reboot' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'ResultAny=yes' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'ResultActive=no' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'ResultInactive=no' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo '' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo '[Enable Shutdown]' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'Identity=unix-user:ubuntu' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'Action=org.freedesktop.login1.power-off' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'ResultAny=yes' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'ResultActive=no' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'ResultInactive=no' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo '' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo '[Enable Suspend]' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'Identity=unix-user:ubuntu' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'Action=org.freedesktop.login1.suspend' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'ResultAny=yes' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'ResultActive=no' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo 'ResultInactive=no' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
    - "echo '' >> /etc/polkit-1/localauthority/50-local.d/10-xrdp.pkla"
